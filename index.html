<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Crabs Tech Related Jargon</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Add flex container for horizontal layout */
    body {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 2rem;
      padding-top: 2rem;
    }

    /* Make both blocks look the same as original */
    .centered {
      white-space: pre;
      text-align: center;
    }

    #blog {
      white-space: pre;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="centered">
       CRABAMONGSPIES
============================
[ STUFF ]
  > <a href="/games">Games</a>
  > <a href="https://www.youtube.com/channel/UC49TI8uG9czJbQy2kGMNjiA?sub_confirmation=1" target="_blank">YouTube</a>
  > <a href="/support">Support me</a>
----------------------------
  </div>

  <!-- Blog Section -->
<div class="centered" id="blog">Loading latest blog post...</div>

<script>
  const blogDiv = document.getElementById('blog');

  const colorMap = {
    r: 'red',
    g: 'green',
    b: 'blue',
    y: 'yellow',
    c: 'cyan',
    m: 'magenta',
    w: 'white',
    k: 'black',
    o: 'orange',
    p: 'purple'
  };

  function parseColors(text) {
    // Replace markup like r%Word%r with colored span
    const parts = text.split(/([rgbymcwkop]%.*?%\1)/gi);
    return parts.map(part => {
      const match = part.match(/^([rgbymcwkop])%(.+?)%\1$/i);
      if (match) {
        const color = colorMap[match[1].toLowerCase()] || 'white';
        const span = document.createElement('span');
        span.style.color = color;
        span.textContent = match[2];
        return span;
      } else {
        // Normal text, replace newlines with <br>
        const container = document.createElement('span');
        container.textContent = part;
        return container;
      }
    });
  }

  async function fetchLatestGist() {
    try {
      const response = await fetch(
        'https://gist.githubusercontent.com/crabamongdev/f8b63c95e751b7d0c6014d0a186376df/raw',
        { cache: "no-store" }
      );
      const content = await response.text();

      // Clear previous content
      blogDiv.innerHTML = '';

      // Parse colored text
      const elements = parseColors(content);
      elements.forEach(el => {
        blogDiv.appendChild(el);
      });
    } catch (err) {
      blogDiv.textContent = 'Error loading blog post: ' + err.message;
    }
  }

  // Fetch immediately
  fetchLatestGist();

  // Auto-refresh every 1 minute (you can adjust)
  setInterval(fetchLatestGist, 60);
</script>
</body>
</html>